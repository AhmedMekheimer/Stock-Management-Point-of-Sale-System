@model SalesInvoicesVM

<div class="p-3">
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h1 class="m-0">Sales Invoices</h1>
	</div>

	<!-- Search and Filters Section -->
	<div class="card mb-3 compact-filter-card">
		<div class="card-body compact-filter-body">
			<form asp-controller="SalesInvoices" asp-action="Index" method="get" class="row g-2 align-items-center">
				<!-- Search -->
				<div class="col-md-4">
					<div class="table-search-wrapper">
						<input asp-for="Search" class="form-control form-control-sm" placeholder="Search by Code, Customer, or User..." />
						<button type="submit" class="btn btn-sm btn-primary">
							<i class="fa fa-search"></i>
						</button>
					</div>
				</div>

				<!-- Branch Filter -->
				<div class="col-md-2">
					<select asp-for="BranchId" asp-items="Model.Branches" class="form-select form-select-sm">
						<option value="">All Branches</option>
					</select>
				</div>

				<!-- Date Filter -->
				<div class="col-md-2">
					<input asp-for="DateFilter" type="date" class="form-control form-control-sm" />
				</div>

				<!-- Total Qty Filter -->
				<div class="col-md-2">
					<input asp-for="TotalQtyFilter" type="number" min="0" class="form-control form-control-sm" placeholder="Min Qty" />
				</div>

				<!-- Grand Total Filter -->
				<div class="col-md-2">
					<input asp-for="GrandTotalFilter" type="number" min="0" class="form-control form-control-sm" placeholder="Min Total" />
				</div>

				<!-- Apply Button -->
				<div class="col-md-2 d-flex justify-content-end align-items-center">
					<button type="submit" class="btn btn-sm btn-primary">Apply</button>
				</div>
			</form>
		</div>
	</div>


	<!-- Invoices Table -->
	<div class="table-responsive">
		<table id="categoryTable" class="table table-striped table-bordered text-center align-middle">
			<thead class="thead-dark">
				<tr>
					<th width="10%">Invoice Code</th>
					<th width="10%">Date</th>
					<th width="5%">Total Qty</th>
					<th width="10%">Grand Total</th>
					<th width="20%">Branch</th>
					<th width="20%">Issued By</th>
					<th width="10%">Customer Served</th>
					<th width="15%">Receipt</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var item in Model.SalesInvoices)
				{
					<tr class="align-middle">
						<td>@item.Code</td>
						<td>@item.Date</td>
						<td>@item.TotalQuantity</td>
						<td>@item.RoundedGrandTotal</td>
						<td>@item.Branch.Name</td>
						<td>@item.ApplicationUser.UserName</td>
						<td>@item.RetailCustomer.Name</td>
						<td>
							<a asp-controller="SalesInvoices"
							   asp-action="GetReceipt"
							   asp-route-id="@item.Id"
							   target="_blank"
							   class="btn btn-sm btn-primary d-flex align-items-center justify-content-center">
								Pdf Receipt <i class="fa-solid fa-arrow-up-right-from-square ms-1"></i>
							</a>
						</td>
					</tr>
				}
			</tbody>
		</table>
	</div>

	<div class="d-flex justify-content-center">
		<nav aria-label="Page navigation example">
			<ul class="pagination custom-pagination mb-0">
				@if (Model.PageId > 1)
				{
					<li class="page-item">
						<a class="page-link" asp-controller="SalesInvoices" asp-action="Index"
						   asp-route-PageId="@(Model.PageId - 1)" asp-route-Search="@Model.Search">
							Previous
						</a>
					</li>
				}
				@for (int i = 1; i <= Model.NoPages; i++)
				{
					<li class="page-item @(i == Model.PageId ? "active" : "")">
						<a class="page-link"
						   asp-controller="SalesInvoices" asp-action="Index" asp-route-PageId="@i" asp-route-Search="@Model.Search">
							@i
						</a>
					</li>
				}
				@if (Model.NoPages > Model.PageId)
				{
					<li class="page-item">
						<a class="page-link" asp-controller="SalesInvoices" asp-action="Index"
						   asp-route-PageId="@(Model.PageId + 1)" asp-route-Search="@Model.Search">
							Next
						</a>
					</li>
				}
			</ul>
		</nav>
	</div>

</div>

@section Styles {
	<link href="~/css/salesinv.css" rel="stylesheet" />
	<link href="~/css/pagination.css" rel="stylesheet" />
}